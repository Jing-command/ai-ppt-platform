# AI PPT Platform - 完整验收标准

**文档版本**: 1.0  
**最后更新**: 2026-02-13  
**适用范围**: 本项目所有迭代、所有功能模块

---

## 📋 验收标准总览

| 迭代 | 模块 | 后端状态 | 前端状态 | 集成测试 | 文档 |
|------|------|----------|----------|----------|------|
| 1 | 用户认证系统 | ⬜ | ⬜ | ⬜ | ⬜ |
| 2 | 连接器管理 | ⬜ | ⬜ | ⬜ | ⬜ |
| 3 | 大纲编辑器 + AI | ⬜ | ⬜ | ⬜ | ⬜ |
| 4 | PPT 编辑器 | ⬜ | ⬜ | ⬜ | ⬜ |
| 5 | 导出系统 | ⬜ | ⬜ | ⬜ | ⬜ |

**图例**: ⬜ 待验收 | ✅ 通过 | ❌ 失败 | 🔄 进行中

---

## 1️⃣ Iteration 1: 用户认证系统

### 1.1 后端 API

#### 1.1.1 用户注册
- [ ] **POST /api/v1/auth/register**
  - [ ] 接受邮箱、密码、用户名
  - [ ] 密码使用 bcrypt 加密存储
  - [ ] 邮箱唯一性验证
  - [ ] 返回 201 和用户数据（不含密码）
  - [ ] 邮箱已存在时返回 409

#### 1.1.2 用户登录
- [ ] **POST /api/v1/auth/login**
  - [ ] 验证邮箱和密码
  - [ ] 返回 JWT access_token 和 refresh_token
  - [ ] 凭证错误时返回 401
  - [ ] Token 有效期符合配置（默认 access: 30分钟, refresh: 7天）

#### 1.1.3 Token 刷新
- [ ] **POST /api/v1/auth/refresh**
  - [ ] 验证 refresh_token
  - [ ] 返回新的 access_token
  - [ ] 无效 token 时返回 401

#### 1.1.4 用户资料
- [ ] **GET /api/v1/auth/me**
  - [ ] 需要有效的 access_token
  - [ ] 返回当前用户信息
  - [ ] 无效 token 时返回 401

### 1.2 前端界面

- [ ] **注册页面**
  - [ ] 邮箱输入框（带格式验证）
  - [ ] 密码输入框（强度提示）
  - [ ] 用户名输入框
  - [ ] 注册按钮（加载状态）
  - [ ] 错误提示（邮箱已存在、格式错误等）
  - [ ] 跳转到登录页链接

- [ ] **登录页面**
  - [ ] 邮箱输入框
  - [ ] 密码输入框
  - [ ] 登录按钮（加载状态）
  - [ ] 错误提示（凭证错误）
  - [ ] 跳转到注册页链接
  - [ ] 登录成功后跳转仪表盘

- [ ] **Token 自动刷新**
  - [ ] 无感知的 token 刷新机制
  - [ ]  refresh_token 过期时跳转登录页

### 1.3 安全要求

- [ ] 所有密码使用 bcrypt 加密（cost factor >= 12）
- [ ] JWT 使用 HS256 算法
- [ ] JWT Secret 存储在环境变量
- [ ] API 限流（每分钟最多 5 次登录尝试）
- [ ] CORS 配置正确

### 1.4 测试要求

- [ ] 单元测试覆盖率 >= 80%
- [ ] 所有 API 端点有测试用例
- [ ] 边界条件测试（空输入、超长输入、特殊字符）
- [ ] 并发测试（同时注册相同邮箱）

---

## 2️⃣ Iteration 2: 连接器管理

### 2.1 后端 API

#### 2.1.1 连接器 CRUD
- [ ] **GET /api/v1/connectors**
  - [ ] 返回用户所有连接器
  - [ ] 支持分页（默认 page=1, page_size=20）
  - [ ] 返回连接器状态（连接成功/失败）

- [ ] **POST /api/v1/connectors**
  - [ ] 创建新连接器
  - [ ] 支持类型：mysql, postgresql, salesforce
  - [ ] 加密存储连接凭证
  - [ ] 返回 201 和连接器信息

- [ ] **GET /api/v1/connectors/{id}**
  - [ ] 返回单个连接器详情
  - [ ] 不包含敏感信息（密码等）
  - [ ] 不存在时返回 404

- [ ] **PUT /api/v1/connectors/{id}**
  - [ ] 更新连接器信息
  - [ ] 部分更新支持
  - [ ] 不存在时返回 404

- [ ] **DELETE /api/v1/connectors/{id}**
  - [ ] 删除连接器
  - [ ] 不存在时返回 404

#### 2.1.2 连接测试
- [ ] **POST /api/v1/connectors/{id}/test**
  - [ ] 测试数据库/API 连接
  - [ ] 返回连接状态
  - [ ] 连接失败时返回详细错误信息
  - [ ] 超时时间 10 秒

#### 2.1.3 数据查询
- [ ] **POST /api/v1/connectors/{id}/query**
  - [ ] 执行查询（仅限 SELECT）
  - [ ] 返回查询结果
  - [ ] 结果限制（默认最多 1000 行）
  - [ ] 查询超时 30 秒
  - [ ] 阻止危险操作（DROP, DELETE, UPDATE）

### 2.2 前端界面

- [ ] **连接器列表页面**
  - [ ] 显示所有连接器卡片
  - [ ] 显示连接状态（颜色标识）
  - [ ] 分页控件
  - [ ] 新建连接器按钮
  - [ ] 编辑/删除操作按钮

- [ ] **新建连接器页面**
  - [ ] 选择连接器类型（下拉框）
  - [ ] 动态表单字段（根据类型变化）
  - [ ] MySQL: 主机、端口、用户名、密码、数据库
  - [ ] Salesforce: Client ID, Client Secret, Username, Password
  - [ ] 测试连接按钮
  - [ ] 保存按钮

- [ ] **测试连接功能**
  - [ ] 实时测试连接状态
  - [ ] 成功/失败提示
  - [ ] 加载状态

### 2.3 连接器类型支持

- [ ] **MySQL**
  - [ ] 支持 MySQL 8.0+
  - [ ] SSL/TLS 连接
  - [ ] 连接池管理

- [ ] **PostgreSQL**
  - [ ] 支持 PostgreSQL 12+
  - [ ] SSL 模式

- [ ] **Salesforce**
  - [ ] OAuth 2.0 认证
  - [ ] API 版本 57.0
  - [ ] Token 自动刷新

### 2.4 安全要求

- [ ] 连接凭证 AES-256 加密存储
- [ ] 数据库连接使用 SSL/TLS
- [ ] API 密钥不存储在客户端
- [ ] 查询语句参数化（防 SQL 注入）

---

## 3️⃣ Iteration 3: 大纲编辑器 + AI 生成

### 3.1 后端 API

#### 3.1.1 大纲 CRUD
- [ ] **GET /api/v1/outlines**
  - [ ] 返回用户所有大纲
  - [ ] 支持分页和筛选（按状态、日期）

- [ ] **POST /api/v1/outlines**
  - [ ] 创建空白大纲
  - [ ] 返回 201 和大纲信息

- [ ] **GET /api/v1/outlines/{id}**
  - [ ] 返回大纲详情（包含 pages）
  - [ ] 返回完整大纲结构

- [ ] **PUT /api/v1/outlines/{id}**
  - [ ] 更新大纲
  - [ ] 支持更新标题、描述、pages
  - [ ] 乐观锁（版本控制）

- [ ] **DELETE /api/v1/outlines/{id}**
  - [ ] 删除大纲
  - [ ] 级联删除相关数据

#### 3.1.2 AI 生成大纲
- [ ] **POST /api/v1/outlines/generate**
  - [ ] 接收主题、页数、可选数据源
  - [ ] 调用 DeepSeek API 生成大纲
  - [ ] 异步处理（返回 task_id）
  - [ ] 生成进度查询接口
  - [ ] 生成时间不超过 60 秒

- [ ] **GET /api/v1/outlines/generate/{task_id}/status**
  - [ ] 查询生成进度
  - [ ] 返回状态：pending, processing, completed, failed
  - [ ] 完成时返回大纲 ID

### 3.2 前端界面

- [ ] **大纲列表页面**
  - [ ] 大纲卡片网格
  - [ ] 显示标题、描述、页数、状态
  - [ ] 新建大纲按钮
  - [ ] AI 生成按钮
  - [ ] 搜索和筛选

- [ ] **AI 生成大纲页面**
  - [ ] 主题输入框（带示例）
  - [ ] 页数选择（5, 10, 15, 20, 25）
  - [ ] 数据源选择（可选连接器）
  - [ ] 生成按钮
  - [ ] 生成进度显示
  - [ ] 预览和编辑跳转

- [ ] **大纲编辑页面**
  - [ ] 章节列表（可拖拽排序）
  - [ ] 添加/删除章节
  - [ ] 编辑章节标题和内容
  - [ ] 每页配图提示词显示
  - [ ] 保存按钮
  - [ ] 生成 PPT 按钮

### 3.3 AI 生成质量要求

- [ ] 生成的大纲逻辑清晰
- [ ] 章节之间有合理递进关系
- [ ] 每页配图提示词具体可用
- [ ] 支持中英文主题
- [ ] 可选数据源集成（连接器数据作为上下文）

### 3.4 性能要求

- [ ] AI 生成响应时间 <= 60 秒
- [ ] 大纲列表加载时间 <= 1 秒
- [ ] 支持大纲草稿自动保存

---

## 4️⃣ Iteration 4: PPT 编辑器

### 4.1 后端 API

#### 4.1.1 演示文稿 CRUD
- [ ] **GET /api/v1/presentations**
  - [ ] 返回用户所有演示文稿
  - [ ] 支持分页

- [ ] **POST /api/v1/presentations**
  - [ ] 从大纲创建演示文稿
  - [ ] 返回 201 和演示文稿信息

- [ ] **GET /api/v1/presentations/{id}**
  - [ ] 返回演示文稿详情
  - [ ] 包含所有幻灯片

- [ ] **PUT /api/v1/presentations/{id}**
  - [ ] 更新演示文稿
  - [ ] 支持更新标题、主题、幻灯片

- [ ] **DELETE /api/v1/presentations/{id}**
  - [ ] 删除演示文稿

#### 4.1.2 幻灯片管理
- [ ] **GET /api/v1/presentations/{id}/slides**
  - [ ] 返回所有幻灯片

- [ ] **POST /api/v1/presentations/{id}/slides**
  - [ ] 添加新幻灯片
  - [ ] 支持指定位置插入

- [ ] **PUT /api/v1/presentations/{id}/slides/{slide_id}**
  - [ ] 更新幻灯片内容
  - [ ] 支持文本、图片、布局

- [ ] **DELETE /api/v1/presentations/{id}/slides/{slide_id}**
  - [ ] 删除幻灯片

#### 4.1.3 撤销/重做
- [ ] **POST /api/v1/presentations/{id}/undo**
  - [ ] 撤销上一步操作
  - [ ] 支持最多 50 步历史

- [ ] **POST /api/v1/presentations/{id}/redo**
  - [ ] 重做上一步操作

### 4.2 前端界面

- [ ] **PPT 列表页面**
  - [ ] 显示所有 PPT 卡片
  - [ ] 缩略图预览
  - [ ] 创建时间、修改时间
  - [ ] 编辑/删除/导出操作

- [ ] **PPT 编辑器页面**
  - [ ] **左侧**: 幻灯片缩略图列表
    - [ ] 可点击切换
    - [ ] 可拖拽排序
    - [ ] 添加/删除幻灯片按钮
  
  - [ ] **中间**: 编辑画布
    - [ ] 文本编辑（富文本）
    - [ ] 图片上传/替换
    - [ ] 拖拽调整元素位置
    - [ ] 实时预览
  
  - [ ] **右侧**: 属性面板
    - [ ] 当前幻灯片属性
    - [ ] 主题选择
    - [ ] 布局选择
  
  - [ ] **顶部**: 工具栏
    - [ ] 撤销/重做按钮
    - [ ] 主题切换（4套主题）
    - [ ] 导出按钮
    - [ ] 保存状态指示

### 4.3 主题系统

- [ ] **default** (白底蓝调)
  - [ ] 背景: #FFFFFF
  - [ ] 主色: #193D6D
  - [ ] 文本: #3C5078

- [ ] **dark** (深色模式)
  - [ ] 背景: #2D2D2D
  - [ ] 主色: #4A90E2
  - [ ] 文本: #E0E0E0

- [ ] **blue** (蓝色渐变)
  - [ ] 背景渐变: #F0F8FF → #E6F3FF
  - [ ] 主色: #193D6D

- [ ] **green** (绿色商务)
  - [ ] 背景: #F0FFF0
  - [ ] 主色: #2E7D32

### 4.4 撤销/重做系统

- [ ] 基于 Command 模式实现
- [ ] 支持 50 步历史
- [ ] 操作类型：添加、删除、修改、移动
- [ ] 快捷键支持（Ctrl+Z, Ctrl+Y）
- [ ] 视觉反馈（按钮状态）

---

## 5️⃣ Iteration 5: 导出系统

### 5.1 后端 API

#### 5.1.1 PPTX 导出
- [ ] **POST /api/v1/exports/pptx**
  - [ ] 导出为 PowerPoint 格式
  - [ ] 支持参数：quality, slide_range, include_notes
  - [ ] 异步处理（返回 task_id）
  - [ ] 使用 python-pptx 库

#### 5.1.2 PDF 导出
- [ ] **POST /api/v1/exports/pdf**
  - [ ] 导出为 PDF 格式
  - [ ] 支持高质量输出
  - [ ] 使用 reportlab 库

#### 5.1.3 图片导出
- [ ] **POST /api/v1/exports/images**
  - [ ] 导出为 PNG/JPG 图片
  - [ ] 每页一张图片
  - [ ] 打包为 ZIP
  - [ ] 使用 Pillow 库

#### 5.1.4 导出任务管理
- [ ] **GET /api/v1/exports/{task_id}/status**
  - [ ] 查询导出进度
  - [ ] 返回进度百分比

- [ ] **GET /api/v1/exports/{task_id}/download**
  - [ ] 下载导出文件
  - [ ] 文件有效期 24 小时

### 5.2 前端界面

- [ ] **导出按钮组件**
  - [ ] 下拉菜单选择格式
  - [ ] PPTX/PDF/PNG/JPG 选项

- [ ] **导出进度显示**
  - [ ] 进度条
  - [ ] 百分比显示
  - [ ] 状态文本
  - [ ] 取消按钮

- [ ] **下载功能**
  - [ ] 自动触发下载
  - [ ] 文件名包含时间戳
  - [ ] 下载完成提示

### 5.3 导出质量要求

- [ ] **PPTX**
  - [ ] 保留编辑能力
  - [ ] 正确应用主题颜色
  - [ ] 图片分辨率 >= 150 DPI
  - [ ] 字体正确嵌入

- [ ] **PDF**
  - [ ] 矢量图形保留
  - [ ] 文本可选中
  - [ ] 文件大小合理

- [ ] **图片**
  - [ ] 分辨率可配置（1x, 2x, 3x）
  - [ ] PNG 支持透明背景
  - [ ] JPG 质量可配置（70%-100%）

### 5.4 异步处理

- [ ] 使用 BackgroundTasks（FastAPI）
- [ ] 或使用 Celery（大规模时）
- [ ] 任务超时 5 分钟
- [ ] 失败时发送通知

---

## 🧪 测试验收标准

### 单元测试

- [ ] 后端测试覆盖率 >= 80%
- [ ] 所有 API 端点有单元测试
- [ ] 所有 Service 层方法有测试
- [ ] 工具函数有测试

### 集成测试

- [ ] 前后端联调通过
- [ ] 完整用户流程测试（注册 → 创建 PPT → 导出）
- [ ] 数据库操作测试
- [ ] 文件上传/下载测试

### E2E 测试

- [ ] 关键用户场景自动化测试
- [ ] 跨浏览器测试（Chrome, Firefox, Safari）
- [ ] 移动端响应式测试

### 性能测试

- [ ] API 响应时间 < 500ms（P95）
- [ ] 页面加载时间 < 3 秒
- [ ] 支持 100 并发用户
- [ ] 内存使用合理（无内存泄漏）

---

## 📚 文档验收标准

### API 文档

- [ ] **Swagger/OpenAPI**
  - [ ] 所有端点有文档
  - [ ] 请求/响应示例
  - [ ] 错误码说明
  - [ ] 认证说明

- [ ] **API 契约文档**
  - [ ] 命名规范
  - [ ] 版本控制策略
  - [ ] 错误处理规范
  - [ ] 响应格式标准

### 开发文档

- [ ] **README.md**
  - [ ] 项目介绍
  - [ ] 快速开始
  - [ ] 技术栈
  - [ ] 目录结构

- [ ] **DEPS.md**
  - [ ] 后端依赖列表
  - [ ] 前端依赖列表
  - [ ] 安装命令

- [ ] **CONTRIBUTING.md** (可选)
  - [ ] 贡献指南
  - [ ] 代码规范

### 部署文档

- [ ] **Docker 支持**
  - [ ] Dockerfile
  - [ ] docker-compose.yml
  - [ ] 部署指南

---

## 🔒 安全验收标准

### 认证安全

- [ ] JWT Secret 长度 >= 256 位
- [ ] Token 过期时间合理
- [ ] 敏感操作需要重新认证
- [ ] 密码重置流程安全

### 数据安全

- [ ] 敏感数据加密存储
- [ ] 数据库连接使用 SSL
- [ ] API 使用 HTTPS
- [ ] 输入验证和过滤

### 访问控制

- [ ] 用户只能访问自己的数据
- [ ] 管理员权限正确控制
- [ ] API 限流配置
- [ ] CORS 白名单

---

## 🚀 部署验收标准

### 环境配置

- [ ] 生产环境变量配置正确
- [ ] 日志级别设置正确
- [ ] 错误监控（Sentry）配置
- [ ] 性能监控配置

### 健康检查

- [ ] **GET /health**
  - [ ] 返回服务状态
  - [ ] 数据库连接检查
  - [ ] 返回 200 或 503

- [ ] **GET /ready**
  - [ ] 返回服务是否就绪
  - [ ] 依赖服务检查

### 备份策略

- [ ] 数据库定期备份
- [ ] 备份恢复测试通过
- [ ] 灾难恢复计划文档

---

## ✅ 验收流程

### 1. 开发完成自检

开发者完成每个功能后，自行检查：
- [ ] 代码符合规范
- [ ] 测试通过
- [ ] 文档已更新

### 2. 代码审查

- [ ] 至少 1 人审查通过
- [ ] 无严重问题
- [ ] 优化建议已记录

### 3. 功能测试

- [ ] 按本标准逐项检查
- [ ] 所有勾选框打勾
- [ ] 问题已记录并修复

### 4. 集成测试

- [ ] 前后端联调通过
- [ ] 完整流程测试通过
- [ ] 性能测试通过

### 5. 最终验收

- [ ] 所有迭代完成
- [ ] 所有测试通过
- [ ] 文档完整
- [ ] 部署就绪

---

## 📝 变更日志

| 日期 | 版本 | 变更 |
|------|------|------|
| 2026-02-13 | 1.0 | 初始版本，整合所有迭代验收标准 |

---

**验收负责人**: _____________  
**验收日期**: _____________  
**验收结果**: ⬜ 通过 | ⬜ 有条件通过 | ⬜ 不通过

**备注**: _______________________________
